<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            box-sizing: border-box;
        }

        .gridElement {
            width: 720px;
            height: 720px;
            display: flex;
            flex-wrap: wrap;
        }

        .gridElement div {
            font-size: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgb(194, 194, 194);
            width: 80px;
            height: 80px;
            background: rgb(56, 56, 56);
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <div id="gridElement1" class="gridElement"></div>
    <BR><BR>


    <script>

        class Sudoku {
            constructor(htmlElement) {
                this.gridElement = document.getElementById(htmlElement);
                this.gridElementArray = [];
                this.gridRow = [];
                this.sectionZero = [];
                this.sectionOne = [];
                this.sectionTwo = [];
                this.sectionThree = [];
                this.sectionFour = [];
                this.sectionFive = [];
                this.sectionSix = [];
                this.sectionSeven = [];
                this.sectionEight = [];
                this.colZero = [];
                this.colOne = [];
                this.colTwo = [];
                this.colThree = [];
                this.colFour = [];
                this.colFive = [];
                this.colSix = [];
                this.colSeven = [];
                this.colEight = [];
                this.smallest = { val: "12345678900" };
                this.createGrid();
                this.sectionGrid();
                this.mainAlgoRunner();
                this.gridDisplay();
                this.findSmallestArrayLength();
            }

            createGrid() {
                for (let i = 0; i < 9; i++) {
                    this.gridElementArray[i] = [];
                    this.gridRow[i] = [];

                    for (let j = 0; j < 9; j++) {
                        this.gridElementArray[i][j] = document.createElement("div");
                        this.gridElement.appendChild(this.gridElementArray[i][j]);
                        this.gridRow[i][j] = {
                            id: i.toString() + j.toString(),
                            val: [0, 1, 2, 3, 4, 5, 6, 7, 8],
                            section: null,
                            col: null,
                            row: i,
                            fin: null

                        }

                    }
                }
            }

            findSmallestArrayLength() {

                const smallestArray = [];

                //Find the smallest val.length
                for (let i = 0; i < 9; i++) {
                    for (let j = 0; j < 9; j++) {
                        if (this.gridRow[i][j].val != undefined
                            && this.gridRow[i][j].val.length < this.smallest.val.length) {
                            this.smallest = this.gridRow[i][j];
                        }

                    }
                }
                //Put all the arrays with that length inside an array

                for (let i = 0; i < 9; i++) {
                    for (let j = 0; j < 9; j++) {
                        if (this.gridRow[i][j].val.length === this.smallest.val.length){
                            smallestArray.push(this.gridRow[i][j]);
                        }
                                            

                    }
                }
                //Randomly pick one of those array objects
                this.smallest = smallestArray[Math.floor(Math.random() * smallestArray.length)];
                console.log(smallestArray);
                console.log(this.smallest)
                //Return it. Congrats we have picked a random object with the lowest value.
                return this.smallest; 
            }



            mainAlgoRunner() {
                this.mainAlgo(this.gridRow[4][4]);
                for (let i = 0; i < 81; i++) {
                    this.findSmallestArrayLength()
                    this.mainAlgo(this.smallest);
                }

            }

            mainAlgo(square) {


                let { val, row, col, section } = square;
                let number;
                let breaker = 0;

                do {
                    number = Math.floor(Math.random() * 9);
                    if (breaker == 190) {
                        console.log("breaker")
                        break;
                    } ++breaker
                }
                while (!val.includes(number) && breaker < 200)

                square.fin = number;
                let tempArray = [];


                for (let i = 0; i < 9; i++) {
                    for (let j = 0; j < 9; j++) {
                        if (this.gridRow[i][j].col === col) {
                            tempArray.push(this.gridRow[i][j]);
                        }
                        if (this.gridRow[i][j].row === row && !tempArray.includes(this.gridRow[i][j])) {
                            tempArray.push(this.gridRow[i][j]);
                        }
                        if (this.gridRow[i][j].section === section && !tempArray.includes(this.gridRow[i][j])) {
                            tempArray.push(this.gridRow[i][j]);
                        }
                    }
                }

                for (let item of tempArray) {
                    if (item.val != undefined && item.val.includes(number)) {
                        item.val.splice(item.val.indexOf(number), 1);
                    }

                }

                square.val = ".............";
                return
            }

            sectionGrid() {
                for (let i = 0; i < 9; i++) {
                    for (let j = 0; j < 9; j++) {
                        //Sections
                        if (i <= 2 && j <= 2) {
                            this.sectionZero.push(this.gridRow[i][j]);
                            this.gridRow[i][j].section = 0;
                        }
                        if (i <= 2 && j >= 3 && j <= 5) {
                            this.sectionOne.push(this.gridRow[i][j]);
                            this.gridRow[i][j].section = 1;
                        }
                        if (i <= 2 && j >= 6 && j <= 8) {
                            this.sectionTwo.push(this.gridRow[i][j]);
                            this.gridRow[i][j].section = 2;
                        }
                        if (i >= 3 && i <= 5 && j <= 2) {
                            this.sectionThree.push(this.gridRow[i][j]);
                            this.gridRow[i][j].section = 3;
                        }
                        if (i >= 3 && i <= 5 && j >= 3 && j <= 5) {
                            this.sectionFour.push(this.gridRow[i][j]);
                            this.gridRow[i][j].section = 4;
                        }
                        if (i >= 3 && i <= 5 && j >= 6 && j <= 8) {
                            this.sectionFive.push(this.gridRow[i][j]);
                            this.gridRow[i][j].section = 5;
                        }
                        if (i >= 6 && i <= 8 && j <= 2) {
                            this.sectionSix.push(this.gridRow[i][j]);
                            this.gridRow[i][j].section = 6;
                        }
                        if (i >= 6 && i <= 8 && j >= 3 && j <= 5) {
                            this.sectionSeven.push(this.gridRow[i][j]);
                            this.gridRow[i][j].section = 7;
                        }
                        if (i >= 6 && i <= 8 && j >= 6 && j <= 8) {
                            this.sectionEight.push(this.gridRow[i][j]);
                            this.gridRow[i][j].section = 8;
                        }

                        //Columns
                        if (j === 0) {
                            this.colZero.push(this.gridRow[i][j]);
                            this.gridRow[i][j].col = 0;
                        }
                        if (j === 1) {
                            this.colOne.push(this.gridRow[i][j]);
                            this.gridRow[i][j].col = 1;
                        }
                        if (j === 2) {
                            this.colTwo.push(this.gridRow[i][j]);
                            this.gridRow[i][j].col = 2;
                        }
                        if (j === 3) {
                            this.colThree.push(this.gridRow[i][j]);
                            this.gridRow[i][j].col = 3;
                        }
                        if (j === 4) {
                            this.colFour.push(this.gridRow[i][j]);
                            this.gridRow[i][j].col = 4;
                        }
                        if (j === 5) {
                            this.colFive.push(this.gridRow[i][j]);
                            this.gridRow[i][j].col = 5;
                        }
                        if (j === 6) {
                            this.colSix.push(this.gridRow[i][j]);
                            this.gridRow[i][j].col = 6;
                        }
                        if (j === 7) {
                            this.colSeven.push(this.gridRow[i][j]);
                            this.gridRow[i][j].col = 7;
                        }
                        if (j === 8) {
                            this.colEight.push(this.gridRow[i][j]);
                            this.gridRow[i][j].col = 8;
                        }

                    }
                }
            }
            gridDisplay() {
                for (let i = 0; i < 9; i++) {
                    for (let j = 0; j < 9; j++) {
                        this.gridElementArray[i][j].innerHTML = "<center>" + this.gridRow[i][j].fin + "<BR>" + this.gridRow[i][j].val
                    }
                }
            }
        }

        const sudoku = new Sudoku("gridElement1");

    </script>
</body>

</html>
